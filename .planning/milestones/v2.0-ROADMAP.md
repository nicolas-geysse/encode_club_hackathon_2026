# Milestone v2.0: Stride Onboarding

**Status:** ✅ SHIPPED 2026-01-31
**Phases:** 1-10
**Total Plans:** 15

## Overview

This milestone delivered two major features:
1. **Swipe-in-Chat** (Phases 1-5): Chat-integrated Swipe experience with intent detection, responsive rendering, and postMessage communication
2. **Fix Onboarding** (Phases 6-10): UX polish including button stability, localization, grid selection, visual animations, and navigation flow

## Phases

### Phase 1: Intent Detection

**Goal:** Chat recognizes when users want to interact with Swipe strategies
**Depends on:** Nothing (first phase)
**Plans:** 1 plan

Plans:
- [x] 01-01: Add swipe intent detection (regex + LLM fallback)

**Details:**
- SWIPE_PATTERNS regex for "swipe", "actions", "stratégies", "strategies"
- French phrase detection: "que puis-je faire?", "quelles options"
- show_swipe_embed action in LLM classifier
- Returns { mode: 'conversation', action: 'show_swipe_embed' }

### Phase 2: UI Resource

**Goal:** Chat API returns properly structured UIResource for swipe embedding
**Depends on:** Phase 1
**Plans:** 1 plan

Plans:
- [x] 02-01: Add swipe_embed UIResource type and API handler

**Details:**
- swipe_embed type in chat.ts UIResource union
- case 'show_swipe_embed' handler creates UIResource
- embedUrl: /embed/swipe, fallbackUrl: /plan?tab=swipe, height: 450

### Phase 3: Embed Route

**Goal:** Standalone swipe route renders SwipeTab without navigation chrome
**Depends on:** Phase 2
**Plans:** 2 plans

Plans:
- [x] 03-01: Create embed route and add embedMode to SwipeTab
- [x] 03-02: Fix layout exclusion for embed routes (gap closure)

**Details:**
- /embed/swipe route renders SwipeTab with embedMode={true}
- app.tsx conditionally bypasses AppLayout for /embed/* routes
- SwipeTab uses reduced padding (p-2) in embed mode

### Phase 4: Responsive Rendering

**Goal:** Chat displays appropriate UI based on viewport size
**Depends on:** Phase 3
**Plans:** 1 plan

Plans:
- [x] 04-01: Add SwipeEmbedResource with responsive iframe/button rendering

**Details:**
- SwipeEmbedResource component in MCPUIRenderer.tsx
- Desktop (>768px): iframe with /embed/swipe
- Mobile (<=768px): "Swipe to plan !" navigation button
- Error fallback: shows button if iframe fails

### Phase 5: Communication

**Goal:** Swipe actions in iframe are acknowledged in chat
**Depends on:** Phase 4
**Plans:** 1 plan

Plans:
- [x] 05-01: Add postMessage bridge for swipe acknowledgments

**Details:**
- SwipeSession sends postMessage when embedMode=true
- Message: { type: 'swipe_completed', direction, scenarioTitle, scenarioId }
- OnboardingChat listens and displays acknowledgment

### Phase 6: Critical Fixes

**Goal:** Fix broken UX that impacts first impression
**Depends on:** Phase 5
**Plans:** 2 plans

Plans:
- [x] 06-01: Remove in-chat Start My Plan button (keep stable sidebar/mobile CTAs)
- [x] 06-02: Translate all French strings to English

**Details:**
- Removed problematic button from ScrollArea (was moving with messages)
- Kept sidebar button (desktop) and bottom CTA (mobile)
- Translated chat.ts, budgetService.ts, llmClassifier.ts, OnboardingChat.tsx

### Phase 7: UX Improvements

**Goal:** Improve selection UX for skills and forms
**Depends on:** Phase 6
**Plans:** 2 plans

Plans:
- [x] 07-01: Create GridMultiSelect component for skills/certifications
- [x] 07-02: Simplify forms (sell, borrow, subscriptions)

**Details:**
- GridMultiSelect: scrollable grid with clickable chips, filter input, counter
- Skills and certifications use grid instead of dropdown
- Inventory: removed category field
- Trade: removed "from whom" field
- Subscriptions: dynamic-list with "Add subscription" button

### Phase 8: Visual Polish

**Goal:** Add visual feedback and animations to onboarding
**Depends on:** Phase 7
**Plans:** 2 plans

Plans:
- [x] 08-01: Enhance progress indicator (lines, pulse, green state)
- [x] 08-02: Add Bruno orbital pulse animation

**Details:**
- Connector lines: 2px solid with full opacity
- Active step: subtle-pulse animation (2s cycle)
- "Generating Plan" step: green text and dot when complete
- Bruno avatar: 3 orbital rings with staggered breathing animation

### Phase 9: Navigation Flow

**Goal:** Progressive disclosure of navigation based on onboarding state
**Depends on:** Phase 8
**Plans:** 2 plans

Plans:
- [x] 09-01: Conditional nav visibility with shared onboarding state store
- [x] 09-02: Quick link shortcuts below Bruno avatar

**Details:**
- onboardingStateStore.ts: shared state for Sidebar/BottomNav
- During onboarding: only "Onboarding" link visible
- After completion: all nav items appear with staggered fade-in
- Quick links: Budget, Goals, Energy → trigger charts in chat via handleUIAction

### Phase 10: Debug

**Goal:** Investigate and document runtime.lastError warning
**Depends on:** Phase 9
**Plans:** 1 plan

Plans:
- [x] 10-01: Investigate runtime errors and document findings

**Details:**
- runtime.lastError: browser extension issue, not app bug
- No chrome.runtime or browser.runtime APIs in app code
- GridMultiSelect confirmed performant (O(n) operations)
- Documented in docs/bugs-dev/fix-onboarding.md

---

## Milestone Summary

**Decimal Phases:** None (all phases executed in order)

**Key Decisions:**
- Hybrid A+C approach: iframe for desktop, button for mobile (avoids touch/scroll issues)
- postMessage one-way communication (parent doesn't need to command iframe)
- 768px breakpoint for mobile/desktop divide
- Shared state store for cross-component navigation visibility
- Quick links trigger charts in chat (user feedback: stay in context)

**Issues Resolved:**
- Start My Plan button instability (removed from ScrollArea)
- French localization (translated to English)
- Navigation clutter during onboarding (conditional visibility)
- runtime.lastError warning (documented as external)

**Issues Deferred:** None

**Technical Debt Incurred:** None

---

*Archived: 2026-01-31 as part of v2.0 milestone completion*
*For current project status, see .planning/ROADMAP.md*
