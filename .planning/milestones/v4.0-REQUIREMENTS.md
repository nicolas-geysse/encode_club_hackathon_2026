# Requirements Archive: v4.0 Goals Tab Fix

**Archived:** 2026-02-02
**Status:** SHIPPED

This is the archived requirements specification for v4.0.
For current requirements, see `.planning/REQUIREMENTS.md` (created for next milestone).

---

## v4.0 Requirements

**Core Value:** Unified and consistent goal progress display that builds user trust
**Reference:** [docs/bugs-dev/goals-fix.md](../../docs/bugs-dev/goals-fix.md)

### Data Architecture

- [x] **ARCH-01**: `useGoalData` hook centralizes all goal data fetching and computation
- [x] **ARCH-02**: `EarningEvent` type with strict date attribution (date, amount, source, weekNumber)
- [x] **ARCH-03**: GoalsTab reduced by 200+ lines through hook extraction
- [x] **ARCH-04**: WeeklyProgressCards and EarningsChart become pure display components

### Calculation Unification

- [x] **CALC-01**: Weekly Need uses capacity-aware calculation everywhere (not linear)
- [x] **CALC-02**: Status calculation uses configurable thresholds (GOAL_STATUS_THRESHOLDS)
- [x] **CALC-03**: Both panel and cards show identical status (ahead/on-track/behind/critical)

### Earnings Aggregation

- [x] **EARN-01**: Chart displays monthly savings at correct weeks (based on income day)
- [x] **EARN-02**: Chart displays completed trades at their completion date
- [x] **EARN-03**: Missions attributed to correct week (using completedAt with updatedAt fallback)

### UX Polish

- [x] **UX-01**: Avatar not cut off (inside card approach for mobile responsiveness)
- [x] **UX-02**: Labels clarified with tooltips ("This Week's Target" vs generic "Weekly Need")
- [x] **UX-03**: Graph legend explains all lines (target, capacity-pace, projection, actual)
- [x] **UX-04**: Consistent color coding for status across all components

## Traceability

| Requirement | Phase | Status |
|-------------|-------|--------|
| ARCH-01 | Phase 20 | Complete |
| ARCH-02 | Phase 20 | Complete |
| ARCH-03 | Phase 21 | Complete |
| ARCH-04 | Phase 21 | Complete |
| EARN-01 | Phase 21 | Complete |
| EARN-02 | Phase 21 | Complete |
| EARN-03 | Phase 21 | Complete |
| CALC-01 | Phase 22 | Complete |
| CALC-02 | Phase 22 | Complete |
| CALC-03 | Phase 22 | Complete |
| UX-01 | Phase 23 | Complete |
| UX-02 | Phase 23 | Complete |
| UX-03 | Phase 23 | Complete |
| UX-04 | Phase 23 | Complete |

---

## Milestone Summary

**Shipped:** 14 of 14 v4.0 requirements
**Adjusted:** None
**Dropped:** None

---
*Archived: 2026-02-02 as part of v4.0 milestone completion*
