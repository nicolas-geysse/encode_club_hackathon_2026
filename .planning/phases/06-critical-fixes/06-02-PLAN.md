---
phase: 06-critical-fixes
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - packages/frontend/src/routes/api/chat.ts
  - packages/frontend/src/lib/budgetService.ts
  - packages/frontend/src/lib/chat/intent/llmClassifier.ts
  - packages/frontend/src/components/chat/OnboardingChat.tsx
autonomous: true

must_haves:
  truths:
    - "All chat bot responses are in English"
    - "All status messages and UI text are in English"
    - "LLM classifier prompt is in English"
  artifacts:
    - path: "packages/frontend/src/routes/api/chat.ts"
      provides: "English response messages"
      contains: "Here's your budget"
    - path: "packages/frontend/src/lib/budgetService.ts"
      provides: "English status labels"
      contains: "Monthly Income"
    - path: "packages/frontend/src/lib/chat/intent/llmClassifier.ts"
      provides: "English classification prompt"
      contains: "You are an intent classifier"
  key_links:
    - from: "chat.ts intent handlers"
      to: "user-facing responses"
      via: "response variable"
      pattern: "response = `.*`"
---

<objective>
Audit and translate all French strings to English in the frontend chat system.

Purpose: Ensure consistent English UX across all bot responses and UI text.
Output: All hardcoded French strings replaced with English equivalents.
</objective>

<execution_context>
@/home/nico/.claude/get-shit-done/workflows/execute-plan.md
@/home/nico/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

Key findings from code analysis - French strings identified:

**1. packages/frontend/src/routes/api/chat.ts:**
- Line 1642: `"Voici les stratÃ©gies disponibles!\n\nSwipe pour choisir tes actions."`
- Line 1671: `"ðŸ“Š **Voici les graphiques disponibles**\n\nClique sur un bouton pour afficher le graphique:"`
- Line 1730: `"Je n'ai pas assez d'informations sur ton budget..."`
- Line 1734: `"ðŸ“Š **RÃ©partition de ton budget mensuel**..."`
- Line 1788: `"Tu n'as pas encore dÃ©fini d'objectif d'Ã©pargne..."`
- Line 1794: `"ðŸ“ˆ **Progression vers ton objectif**..."`
- Line 1826: `"Je n'ai pas assez d'informations pour une projection..."`
- Line 1955: `"âš¡ Je n'ai pas encore de donnÃ©es sur ton niveau d'Ã©nergie..."`
- Line 1959: `"âš¡ **Ã‰volution de ton Ã©nergie**..."`
- Line 1977: `"ðŸ“Š Pour comparer des scÃ©narios, utilise les commandes \"et si...\"..."`

**2. packages/frontend/src/lib/budgetService.ts:**
- Line 257-309: `formatBudgetForChat()` uses French labels
- Line 335-341: Health messages in French

**3. packages/frontend/src/lib/chat/intent/llmClassifier.ts:**
- Line 52-86: Entire classification prompt is in French

**4. packages/frontend/src/components/chat/OnboardingChat.tsx:**
- Line 697-701: Chart button messages in French

Note: French patterns in `detector.ts` are INTENTIONAL for detecting French input and should NOT be changed.

@packages/frontend/src/routes/api/chat.ts
@packages/frontend/src/lib/budgetService.ts
@packages/frontend/src/lib/chat/intent/llmClassifier.ts
@packages/frontend/src/components/chat/OnboardingChat.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Translate chat.ts response messages to English</name>
  <files>packages/frontend/src/routes/api/chat.ts</files>
  <action>
Replace all French response strings with English:

1. **Line 1642** (show_swipe_embed):
FROM: `response = \`Voici les stratÃ©gies disponibles!\n\nSwipe pour choisir tes actions.\`;`
TO: `response = \`Here are your available strategies!\n\nSwipe to choose your actions.\`;`

2. **Line 1671** (show_chart_gallery):
FROM: `response = \`ðŸ“Š **Voici les graphiques disponibles**\n\nClique sur un bouton pour afficher le graphique:\`;`
TO: `response = \`ðŸ“Š **Available Charts**\n\nClick a button to display the chart:\`;`

3. **Line 1730** (show_budget_chart - no data):
FROM: `response = \`Je n'ai pas assez d'informations sur ton budget. Dis-moi ton revenu et tes dÃ©penses d'abord!\`;`
TO: `response = \`I don't have enough budget information yet. Tell me your income and expenses first!\`;`

4. **Line 1734** (show_budget_chart - success):
FROM: `response = \`ðŸ“Š **RÃ©partition de ton budget mensuel**\n\nRevenus: **\${currSymbol}\${income}** | DÃ©penses: **\${currSymbol}\${expenses}** | Ã‰pargne: **\${currSymbol}\${savings}**\`;`
TO: `response = \`ðŸ“Š **Your Monthly Budget**\n\nIncome: **\${currSymbol}\${income}** | Expenses: **\${currSymbol}\${expenses}** | Savings: **\${currSymbol}\${savings}**\`;`

5. **Line 1788** (show_progress_chart - no goal):
FROM: `response = \`Tu n'as pas encore dÃ©fini d'objectif d'Ã©pargne. CrÃ©e un objectif d'abord!\`;`
TO: `response = \`You haven't set a savings goal yet. Create a goal first!\`;`

6. **Line 1794** (show_progress_chart - success):
FROM: `response = \`ðŸ“ˆ **Progression vers ton objectif**\n\nDÃ©jÃ  Ã©pargnÃ©: **\${currSymbol}\${currentSaved}** sur **\${currSymbol}\${goalAmount}**\`;`
TO: `response = \`ðŸ“ˆ **Progress Towards Your Goal**\n\nAlready saved: **\${currSymbol}\${currentSaved}** of **\${currSymbol}\${goalAmount}**\`;`

7. **Line ~1826** (show_projection_chart - no data):
FROM: `response = \`Je n'ai pas assez d'informations pour une projection. DÃ©finis un objectif avec une deadline d'abord!\`;`
TO: `response = \`I don't have enough information for a projection. Set a goal with a deadline first!\`;`

8. **Line 1955** (show_energy_chart - no data):
FROM: `response = \`âš¡ Je n'ai pas encore de donnÃ©es sur ton niveau d'Ã©nergie. Commence par enregistrer ton Ã©nergie sur la page de Suivi!\`;`
TO: `response = \`âš¡ I don't have energy data yet. Start by logging your energy on the Tracking page!\`;`

9. **Line 1959** (show_energy_chart - success):
FROM: `response = \`âš¡ **Ã‰volution de ton Ã©nergie**\n\nLes lignes en pointillÃ© indiquent les seuils: rouge (40%) = fatigue, vert (80%) = rÃ©cupÃ©ration.\`;`
TO: `response = \`âš¡ **Your Energy History**\n\nDashed lines indicate thresholds: red (40%) = fatigue, green (80%) = recovery.\`;`

10. **Line 1977** (show_comparison_chart):
FROM: `response = \`ðŸ“Š Pour comparer des scÃ©narios, utilise les commandes "et si...". Par exemple:\n\n- "Et si je travaillais 5h/semaine?"\n- "Et si je vendais mon vÃ©lo?"\n- "Et si j'arrÃªtais Netflix?"\n\nOu choisis un graphique ci-dessous:\`;`
TO: `response = \`ðŸ“Š To compare scenarios, use "what if" commands. For example:\n\n- "What if I worked 5h/week?"\n- "What if I sold my bike?"\n- "What if I canceled Netflix?"\n\nOr choose a chart below:\`;`
  </action>
  <verify>
1. Search for French patterns: `grep -n "Voici\|Je n'ai pas\|Tu n'as\|ton budget\|ton objectif\|ton Ã©nergie" packages/frontend/src/routes/api/chat.ts` - should return nothing
2. Run `pnpm typecheck` - must pass
  </verify>
  <done>
- All chat.ts response messages are in English
  </done>
</task>

<task type="auto">
  <name>Task 2: Translate budgetService.ts labels to English</name>
  <files>packages/frontend/src/lib/budgetService.ts</files>
  <action>
Replace French labels in `formatBudgetForChat()` function (lines 256-310):

1. **Line 257**: `['Situation FinanciÃ¨re:']` â†’ `['Financial Summary:']`

2. **Line 261**: `'REVENUS MENSUELS (rÃ©current):'` â†’ `'MONTHLY INCOME (recurring):'`

3. **Line 262**: `'- Revenus:'` â†’ `'- Income:'`

4. **Line 263**: `'- DÃ©penses:'` â†’ `'- Expenses:'`

5. **Line 264**: `'- Marge nette:'` â†’ `'- Net margin:'`

6. **Line 269**: `'GAINS PONCTUELS RÃ‰ALISÃ‰S:'` â†’ `'ONE-TIME GAINS (realized):'`

7. **Line 271**: `'- Ventes complÃ©tÃ©es:'` â†’ `'- Completed sales:'`

8. **Line 274**: `'- Emprunts Ã©conomisÃ©s:'` â†’ `'- Borrowing savings:'`

9. **Line 277**: `'- Items pausÃ©s:'` â†’ `'- Paused items:'`

10. **Line 279**: `'- Total gains ponctuels:'` â†’ `'- Total one-time gains:'`

11. **Line 285**: `'GAINS POTENTIELS (non rÃ©alisÃ©s):'` â†’ `'POTENTIAL GAINS (unrealized):'`

12. **Line 287**: `'- Ventes en attente:'` â†’ `'- Pending sales:'`

13. **Line 290**: `'- Emprunts potentiels:'` â†’ `'- Potential borrowing:'`

14. **Line 297**: `'PROJECTION VERS OBJECTIF:'` â†’ `'GOAL PROJECTION:'`

15. **Line 298**: `'- Objectif:'` â†’ `'- Goal:'`

16. **Line 299**: `'- Mois restants:'` â†’ `'- Months remaining:'`

17. **Line 300**: `'- Via marge mensuelle:'` â†’ `'- From monthly margin:'`

18. **Line 301**: `'- Via gains ponctuels:'` â†’ `'- From one-time gains:'`

19. **Line 302**: `'- TOTAL PROJETÃ‰:'` â†’ `'- PROJECTED TOTAL:'`

20. **Line 304**: `'- Potentiel additionnel:'` â†’ `'- Additional potential:'`

21. **Line 306**: `'- Progression:'` â†’ `'- Progress:'`

Also translate health messages (lines 335-341):

22. **Line 335**: `'Marge saine'` â†’ `'Healthy margin'`

23. **Line 341**: `'Marge nÃ©gative'` â†’ `'Negative margin'`

24. **Line 358**: `'Objectif Ã  risque'` â†’ `'Goal at risk'`

25. **Line 395**: `'Budget calculÃ©'` â†’ `'Budget calculated'`
  </action>
  <verify>
1. Search for French patterns: `grep -n "Revenus\|DÃ©penses\|Marge\|Objectif\|ponctuels" packages/frontend/src/lib/budgetService.ts` - should return nothing
2. Run `pnpm typecheck` - must pass
  </verify>
  <done>
- All budgetService.ts labels are in English
  </done>
</task>

<task type="auto">
  <name>Task 3: Translate LLM classifier prompt to English</name>
  <files>packages/frontend/src/lib/chat/intent/llmClassifier.ts</files>
  <action>
Replace the entire INTENT_CLASSIFICATION_PROMPT constant (lines 52-86):

FROM (French):
```typescript
const INTENT_CLASSIFICATION_PROMPT = `Tu es un classificateur d'intentions pour Stride, une app de finances Ã©tudiantes.

CONTEXTE ACTUEL:
- Mode: {mode}
- Ã‰tape: {currentStep}
- DonnÃ©es utilisateur: goal={hasGoal}, budget={hasBudget}, energy={hasEnergy}

ACTIONS DISPONIBLES:
- show_chart_gallery: L'utilisateur veut voir les graphiques/visualisations disponibles (mots clÃ©s: charts, graphiques, visuels, visualisations, diagrammes)
- show_budget_chart: L'utilisateur veut voir son budget en graphique (revenus, dÃ©penses, Ã©pargne)
- show_progress_chart: L'utilisateur veut voir sa progression vers son objectif d'Ã©pargne
- show_projection_chart: L'utilisateur veut voir des projections financiÃ¨res futures
- show_energy_chart: L'utilisateur veut voir son historique d'Ã©nergie/fatigue
- show_swipe_embed: L'utilisateur veut voir/utiliser les stratÃ©gies swipe, explorer ses options d'action (mots clÃ©s: swipe, actions, stratÃ©gies, que puis-je faire, quelles options)
- whatif_work: L'utilisateur pose une question "et si je travaillais X heures"
- whatif_sell: L'utilisateur veut simuler une vente d'objet
- whatif_cut: L'utilisateur veut simuler l'arrÃªt d'une dÃ©pense/abonnement
- check_progress: L'utilisateur veut connaÃ®tre sa progression actuelle (sans graphique)
- get_advice: L'utilisateur demande des conseils financiers
- continue_onboarding: L'utilisateur veut continuer/reprendre l'onboarding (SEULEMENT si mode=onboarding)
- conversation: Conversation gÃ©nÃ©rale sans action spÃ©cifique (salutations, remerciements, questions gÃ©nÃ©rales)

RÃˆGLES IMPORTANTES:
1. "continue", "on continue" en mode onboarding â†’ continue_onboarding
2. "continue" en mode conversation â†’ conversation (pas d'action spÃ©ciale)
3. Mots simples comme "charts", "graphiques", "visuel", "visualisation" â†’ show_chart_gallery
4. "chart please", "j'aimerais voir des visuels" â†’ show_chart_gallery
5. Demandes visuelles sans type spÃ©cifique â†’ show_chart_gallery
6. Salutations (bonjour, hello, merci, thanks) â†’ conversation
7. Si incertain (< 70% confiance), retourner conversation avec confidence basse

RÃ©ponds UNIQUEMENT avec un JSON valide sans markdown:
{"action": "nom_action", "confidence": 0.0-1.0, "reasoning": "explication courte"}

Message utilisateur: "{message}"`;
```

TO (English):
```typescript
const INTENT_CLASSIFICATION_PROMPT = `You are an intent classifier for Stride, a student financial health app.

CURRENT CONTEXT:
- Mode: {mode}
- Step: {currentStep}
- User data: goal={hasGoal}, budget={hasBudget}, energy={hasEnergy}

AVAILABLE ACTIONS:
- show_chart_gallery: User wants to see available charts/visualizations (keywords: charts, graphs, visuals, visualizations, diagrams)
- show_budget_chart: User wants to see their budget as a chart (income, expenses, savings)
- show_progress_chart: User wants to see progress towards their savings goal
- show_projection_chart: User wants to see future financial projections
- show_energy_chart: User wants to see their energy/fatigue history
- show_swipe_embed: User wants to see/use swipe strategies, explore action options (keywords: swipe, actions, strategies, what can I do, what options)
- whatif_work: User asks "what if I worked X hours"
- whatif_sell: User wants to simulate selling an item
- whatif_cut: User wants to simulate stopping a subscription/expense
- check_progress: User wants to know their current progress (without chart)
- get_advice: User asks for financial advice
- continue_onboarding: User wants to continue/resume onboarding (ONLY if mode=onboarding)
- conversation: General conversation without specific action (greetings, thanks, general questions)

IMPORTANT RULES:
1. "continue", "let's continue" in onboarding mode â†’ continue_onboarding
2. "continue" in conversation mode â†’ conversation (no special action)
3. Simple words like "charts", "graphs", "visual", "visualization" â†’ show_chart_gallery
4. "chart please", "show me some visuals" â†’ show_chart_gallery
5. Visual requests without specific type â†’ show_chart_gallery
6. Greetings (hello, hi, thanks, thank you) â†’ conversation
7. If uncertain (< 70% confidence), return conversation with low confidence

Respond ONLY with valid JSON without markdown:
{"action": "action_name", "confidence": 0.0-1.0, "reasoning": "brief explanation"}

User message: "{message}"`;
```
  </action>
  <verify>
1. Search for French patterns: `grep -n "Tu es\|utilisateur\|RÃ©pondre\|franÃ§ais" packages/frontend/src/lib/chat/intent/llmClassifier.ts` - should return nothing
2. Run `pnpm typecheck` - must pass
  </verify>
  <done>
- LLM classifier prompt is fully in English
  </done>
</task>

<task type="auto">
  <name>Task 4: Translate chart button messages in OnboardingChat.tsx</name>
  <files>packages/frontend/src/components/chat/OnboardingChat.tsx</files>
  <action>
Replace French chart messages (around lines 696-704):

FROM:
```typescript
          const chartMessages: Record<string, string> = {
            budget_breakdown: 'Montre-moi mon budget en graphique',
            progress: 'Montre-moi ma progression',
            projection: 'Montre-moi mes projections',
            comparison: 'Montre-moi une comparaison de scÃ©narios',
            energy: "Montre-moi mon historique d'Ã©nergie",
          };
```

TO:
```typescript
          const chartMessages: Record<string, string> = {
            budget_breakdown: 'Show me my budget chart',
            progress: 'Show me my progress',
            projection: 'Show me my projections',
            comparison: 'Show me a scenario comparison',
            energy: 'Show me my energy history',
          };
```
  </action>
  <verify>
1. Search for French patterns: `grep -n "Montre-moi" packages/frontend/src/components/chat/OnboardingChat.tsx` - should return nothing
2. Run `pnpm typecheck` - must pass
  </verify>
  <done>
- Chart button trigger messages are in English
  </done>
</task>

</tasks>

<verification>
After task completion:

1. **TypeScript:** `pnpm typecheck` passes
2. **Lint:** `pnpm lint` passes
3. **Global French search:**
   ```bash
   grep -rn "Voici\|Je n'ai pas\|Tu n'as\|ton budget\|Montre-moi\|Revenus\|DÃ©penses\|Marge\|ponctuels\|Objectif Ã \|Tu es un" packages/frontend/src/routes/api/chat.ts packages/frontend/src/lib/budgetService.ts packages/frontend/src/lib/chat/intent/llmClassifier.ts packages/frontend/src/components/chat/OnboardingChat.tsx
   ```
   Should return NO results
4. **Manual test:**
   - Ask Bruno "show me charts" â†’ Response should be in English
   - Ask Bruno "show me my budget" â†’ Response should be in English
   - If no energy data, response should say "I don't have energy data yet..."
</verification>

<success_criteria>
- Success Criterion 3: All chat responses and UI text are in English âœ“
</success_criteria>

<output>
After completion, create `.planning/phases/06-critical-fixes/06-02-SUMMARY.md`
</output>
