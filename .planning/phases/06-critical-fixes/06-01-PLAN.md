---
phase: 06-critical-fixes
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - packages/frontend/src/components/chat/OnboardingChat.tsx
autonomous: true

must_haves:
  truths:
    - "Start My Plan button stays in a fixed position when new messages are added"
    - "Button does not duplicate or re-render as a message in the chat flow"
    - "Only one Start My Plan button visible (in sidebar area) when complete"
  artifacts:
    - path: "packages/frontend/src/components/chat/OnboardingChat.tsx"
      provides: "Stable Start My Plan button positioned outside message list"
      contains: "isComplete()"
  key_links:
    - from: "isComplete signal"
      to: "Start My Plan button visibility"
      via: "Show when condition"
      pattern: "Show.*when.*isComplete"
---

<objective>
Fix the Start My Plan button positioning so it stays stable and doesn't move when new messages are added.

Purpose: Fix critical UX issue where the CTA button is unstable, hurting first impression.
Output: Modified OnboardingChat with stable button positioning outside the message scroll area.
</objective>

<execution_context>
@/home/nico/.claude/get-shit-done/workflows/execute-plan.md
@/home/nico/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

Key findings from code analysis:
- OnboardingChat.tsx has THREE "Start My Plan" buttons:
  1. Line 2491-2515: In left sidebar next to restart button (fades in when complete)
  2. Line 2586-2608: Inside ScrollArea, after messages (problematic - moves with scroll)
  3. Line 2646-2665: Mobile-only CTA below input area

Problem:
- Button #2 is inside the message list ScrollArea (line 2529-2612)
- When new messages are added, this button moves because it's part of the message flow
- This creates the "reappears as last message" illusion

Solution:
- Remove the in-chat-area button (#2 at line 2586-2608)
- Keep sidebar button (#1) for desktop
- Keep mobile CTA (#3) for mobile
- Both #1 and #3 are already OUTSIDE the ScrollArea, so they're stable

@packages/frontend/src/components/chat/OnboardingChat.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove the in-chat-area Start My Plan button</name>
  <files>packages/frontend/src/components/chat/OnboardingChat.tsx</files>
  <action>
1. **Locate and remove the problematic button** (lines 2586-2608):

Find this block inside the ScrollArea, after the OnboardingFormStep Show block:

```tsx
              {/* Start my plan CTA - in chat area after completion */}
              <Show when={isComplete()}>
                <div class="flex justify-center mt-6 mb-4 animate-in slide-in-from-bottom-4 duration-500">
                  <GlassButton onClick={goToPlan}>
                    Start My Plan
                    <svg
                      class="animate-bounce-x"
                      xmlns="http://www.w3.org/2000/svg"
                      width="18"
                      height="18"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2.5"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    >
                      <path d="M5 12h14" />
                      <path d="m12 5 7 7-7 7" />
                    </svg>
                  </GlassButton>
                </div>
              </Show>
```

**DELETE this entire block.** This is the only change needed.

The button will still appear in:
- Desktop: Left sidebar (line 2491-2515) - already stable
- Mobile: Below input area (line 2646-2665) - already stable
  </action>
  <verify>
1. Count "Start My Plan" occurrences in the file - should be 3 (was 4 before: 2 buttons + 2 comments)
2. Run `pnpm typecheck` - must pass
3. Run `pnpm lint` - must pass
  </verify>
  <done>
- In-chat-area button removed
- Desktop users see stable sidebar button when complete
- Mobile users see stable bottom CTA when complete
- No button moves when new messages arrive
  </done>
</task>

</tasks>

<verification>
After task completion:

1. **TypeScript:** `pnpm typecheck` passes
2. **Lint:** `pnpm lint` passes
3. **Manual test - Desktop:**
   - Complete onboarding to reach `isComplete()` state
   - "Start My Plan" button should appear in left sidebar (next to restart)
   - Send a new message (e.g., "hello")
   - Button should NOT move or flash
   - Button should stay in the same position
4. **Manual test - Mobile:**
   - Complete onboarding on mobile viewport
   - "Start My Plan" button should appear below the input area
   - Send a new message
   - Button should stay stable below input
5. **No duplicate buttons visible** at any point
</verification>

<success_criteria>
- Success Criterion 1: "Start my plan" button stays in place when new messages are added ✓
- Success Criterion 2: No duplicate "Start my plan" button in sidebar ✓ (there was never a duplicate - the issue was the in-chat button)
</success_criteria>

<output>
After completion, create `.planning/phases/06-critical-fixes/06-01-SUMMARY.md`
</output>
