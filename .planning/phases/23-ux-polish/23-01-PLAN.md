---
phase: 23-ux-polish
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - packages/frontend/src/components/WeeklyProgressCards.tsx
autonomous: true

must_haves:
  truths:
    - "Avatar (walking emoji) is fully visible on both desktop and mobile screens"
    - "Avatar is positioned inside the card container for predictable mobile behavior"
    - "Current week card has proper top padding to accommodate the avatar"
  artifacts:
    - path: "packages/frontend/src/components/WeeklyProgressCards.tsx"
      provides: "Fixed avatar positioning inside card"
      contains: "pt-8"
  key_links:
    - from: "packages/frontend/src/components/WeeklyProgressCards.tsx"
      to: "Current week card styling"
      via: "Conditional padding for current week"
      pattern: "isCurrentWeek.*pt-8"
---

<objective>
Fix the avatar positioning in WeeklyProgressCards so the walking emoji marker for the current week is not cut off on mobile or desktop.

Purpose: The current avatar is positioned absolutely above the card (-top-3) but the parent container clips it. This creates a poor visual experience where the avatar is partially hidden.

Output: WeeklyProgressCards with avatar properly visible inside the card container using the "Option C" approach recommended in goals-fix.md.
</objective>

<execution_context>
@/home/nico/.claude/get-shit-done/workflows/execute-plan.md
@/home/nico/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@docs/bugs-dev/goals-fix.md (Section 4.4 - Corriger l'Avatar Flottant)

# Key file to modify
@packages/frontend/src/components/WeeklyProgressCards.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix avatar positioning with inside-card approach</name>
  <files>packages/frontend/src/components/WeeklyProgressCards.tsx</files>
  <action>
Modify the current week card to properly display the avatar:

1. Find the card wrapper div (around line 380-386) that has the conditional styling for current week:
```tsx
<div
  class={cn(
    'flex-shrink-0 w-28 p-2 rounded-lg border-2 transition-all relative',
    config.bg,
    config.border,
    isCurrentWeek && 'ring-2 ring-green-500 ring-offset-2 animate-pulse-subtle'
  )}
>
```

2. Add conditional top padding for the current week to make room for the avatar inside the card:
   - Add `isCurrentWeek && 'pt-8'` to the cn() call to add top padding when it's the current week
   - This ensures the avatar has space above the card content

3. The avatar div (around line 388-392) is already positioned with `-top-3 left-1/2`:
```tsx
<Show when={isCurrentWeek}>
  <div class="absolute -top-3 left-1/2 animate-bounce-slow z-10">
    <span class="text-lg">ðŸš¶</span>
  </div>
</Show>
```

4. Change the avatar positioning to use `-translate-x-1/2` for proper horizontal centering:
   - Update the div class to include `-translate-x-1/2` (may already be there, verify)
   - Keep the `-top-3` positioning but ensure pt-8 on the card provides enough space

5. The resulting structure should be:
   - Card with `pt-8` when current week (creates space at top)
   - Avatar positioned at `-top-3 left-1/2 -translate-x-1/2` (sits in the padding space)
   - z-10 ensures avatar appears above other content

Do NOT add overflow-visible to the scroll container as this would break the horizontal scroll behavior.
  </action>
  <verify>
Run `pnpm dev` and navigate to http://localhost:3006/plan, select Goals tab:
1. Find the current week card (has green ring highlight)
2. Verify the walking emoji (ðŸš¶) is fully visible, not cut off
3. Check on mobile viewport (Chrome DevTools, 375px width) - avatar should still be visible
4. Verify other cards are not affected (no extra padding on non-current weeks)
  </verify>
  <done>
The walking emoji avatar on the current week card is fully visible on both desktop and mobile viewports. The card has extra top padding only when it's the current week. The avatar sits in the padding space and is not clipped by any container.
  </done>
</task>

<task type="auto">
  <name>Task 2: Add responsive fallback for larger screens</name>
  <files>packages/frontend/src/components/WeeklyProgressCards.tsx</files>
  <action>
Add a media query responsive enhancement for desktop screens where the avatar can be slightly larger:

1. The avatar is currently `text-lg` (18px). On desktop screens where there's more room, we can make it slightly more prominent.

2. Update the avatar styling to use responsive classes:
   - Change `text-lg` to `text-lg md:text-xl` so it's larger on medium+ screens
   - Keep the bounce animation for visual interest

3. Ensure the z-index (z-10) is sufficient to render above the ring effect and card content.

4. Optional enhancement: Add a subtle background circle behind the emoji for better visibility:
   - Only if the emoji looks too "floating" without context
   - Use `bg-white dark:bg-slate-800 rounded-full p-0.5 shadow-sm` wrapper if needed
   - This is optional - skip if the emoji looks good on its own

The goal is minimal changes that improve visibility without over-engineering.
  </action>
  <verify>
1. On desktop (1024px+ viewport), the avatar should be slightly larger but still proportional
2. On mobile, avatar remains the same size as before
3. No visual regression on the rest of the card layout
4. Dark mode: avatar is visible against dark backgrounds
  </verify>
  <done>
Avatar is responsive with appropriate sizing for mobile and desktop. Visual appearance is clean and the avatar is clearly visible as a marker for the current week.
  </done>
</task>

</tasks>

<verification>
After all tasks:
1. Run `pnpm typecheck` - should pass with no errors
2. Run `pnpm lint` - should pass (or only pre-existing warnings)
3. Visual check: Navigate to /plan > Goals tab, verify avatar is fully visible
4. Mobile check: Use DevTools responsive mode at 375px width, verify avatar not clipped
5. Scroll check: Horizontal scrolling still works, avatar doesn't break scroll container
</verification>

<success_criteria>
- [ ] Avatar (walking emoji) is 100% visible on both desktop and mobile
- [ ] Current week card has extra top padding to accommodate avatar
- [ ] Non-current week cards are unchanged (no extra padding)
- [ ] Horizontal scroll behavior is preserved
- [ ] TypeScript compiles without errors
- [ ] No visual regressions on the rest of WeeklyProgressCards
</success_criteria>

<output>
After completion, create `.planning/phases/23-ux-polish/23-01-SUMMARY.md`
</output>
