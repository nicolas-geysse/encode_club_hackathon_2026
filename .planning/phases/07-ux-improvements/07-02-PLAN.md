---
phase: 07-ux-improvements
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - packages/frontend/src/lib/chat/stepForms.ts
autonomous: true

must_haves:
  truths:
    - "Items to sell form has only name and estimated price fields (no category)"
    - "Borrow form has only type, item name, and cost saved fields (no 'from whom')"
    - "Subscriptions can add multiple items with 'Add subscription' button"
  artifacts:
    - path: "packages/frontend/src/lib/chat/stepForms.ts"
      provides: "Simplified form configurations"
      contains: "addLabel: 'Add subscription'"
  key_links:
    - from: "stepForms.ts inventory config"
      to: "OnboardingFormStep DynamicListField"
      via: "dynamic-list type rendering"
      pattern: "type.*dynamic-list"
---

<objective>
Simplify onboarding forms by removing unnecessary fields and adding multi-subscription support

Purpose: Reduce friction in onboarding by removing fields users don't care about (category, "from whom") and enabling multiple subscription entries.

Output: Updated stepForms.ts with simplified inventory/trade configs and dynamic-list subscriptions.
</objective>

<execution_context>
@/home/nico/.claude/get-shit-done/workflows/execute-plan.md
@/home/nico/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@packages/frontend/src/lib/chat/stepForms.ts
@docs/bugs-dev/fix-onboarding.md (Section 4: Form Simplifications)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove category from inventory and partner from trade</name>
  <files>packages/frontend/src/lib/chat/stepForms.ts</files>
  <action>
Modify the form configurations in stepForms.ts:

**1. Inventory (Items to Sell) - Remove category field:**

Find the `inventory` configuration (around line 514-550) and remove the category field from `itemFields`.

Current itemFields:
```typescript
itemFields: [
  { name: 'name', ... },
  { name: 'estimatedValue', ... },
  { name: 'category', type: 'select', label: 'Category', options: INVENTORY_CATEGORIES },
]
```

Change to (remove category entirely):
```typescript
itemFields: [
  {
    name: 'name',
    type: 'text',
    label: 'Item',
    placeholder: 'e.g., Old laptop',
    required: true,
  },
  {
    name: 'estimatedValue',
    type: 'number',
    label: 'Estimated price',
    placeholder: '50',
    min: 0,
    suffix: '$',
  },
]
```

**2. Trade (Borrow) - Remove partner field:**

Find the `trade` configuration (around line 552-595) and remove the partner field from `itemFields`.

Current itemFields:
```typescript
itemFields: [
  { name: 'type', ... },
  { name: 'name', ... },
  { name: 'partner', type: 'text', label: 'From whom?', placeholder: 'e.g., Alex' },
  { name: 'estimatedSavings', ... },
]
```

Change to (remove partner entirely):
```typescript
itemFields: [
  {
    name: 'type',
    type: 'select',
    label: 'Type',
    options: TRADE_TYPES,
    required: true,
  },
  {
    name: 'name',
    type: 'text',
    label: 'Item',
    placeholder: 'e.g., Camping tent',
    required: true,
  },
  {
    name: 'estimatedSavings',
    type: 'number',
    label: 'Cost saved',
    placeholder: '50',
    min: 0,
    suffix: '$',
  },
]
```

**Do NOT:**
- Remove the `INVENTORY_CATEGORIES` constant (may be used elsewhere)
- Change any other form configurations
  </action>
  <verify>
Verify the fields are removed:
```bash
grep -A 20 "inventory:" packages/frontend/src/lib/chat/stepForms.ts | grep -c "category" # Should be 0
grep -A 20 "trade:" packages/frontend/src/lib/chat/stepForms.ts | grep -c "partner" # Should be 0
```
  </verify>
  <done>Inventory form has no category field, trade form has no partner field</done>
</task>

<task type="auto">
  <name>Task 2: Convert subscriptions to dynamic-list</name>
  <files>packages/frontend/src/lib/chat/stepForms.ts</files>
  <action>
Modify the `lifestyle` configuration (around line 597-607) to use dynamic-list type instead of simple text.

Current configuration:
```typescript
lifestyle: {
  fields: [
    {
      name: 'subscriptions',
      type: 'text',
      label: 'Current subscriptions',
      placeholder: 'e.g., Netflix, Spotify, Gym',
    },
  ],
  helpText: "We'll help identify subscriptions you might optimize or cancel.",
},
```

Change to:
```typescript
lifestyle: {
  fields: [
    {
      name: 'subscriptions',
      type: 'dynamic-list',
      label: 'Current subscriptions',
      config: {
        itemFields: [
          {
            name: 'name',
            type: 'text',
            label: 'Service',
            placeholder: 'e.g., Netflix',
            required: true,
          },
          {
            name: 'currentCost',
            type: 'number',
            label: 'Monthly cost',
            placeholder: '15',
            min: 0,
            suffix: '$',
          },
        ],
        addLabel: 'Add subscription',
        maxItems: 15,
      },
    },
  ],
  helpText: "We'll help identify subscriptions you might optimize or cancel.",
},
```

This matches the `Subscription` type in types.ts which has `{ name: string; currentCost: number; }`.

**Do NOT:**
- Change the types.ts Subscription interface (it already matches)
- Modify how DynamicListField renders (it already handles this pattern)
  </action>
  <verify>
Verify the subscriptions config uses dynamic-list:
```bash
grep -A 5 "name: 'subscriptions'" packages/frontend/src/lib/chat/stepForms.ts | grep "dynamic-list"
```
  </verify>
  <done>Subscriptions step allows adding multiple subscriptions with name and cost</done>
</task>

</tasks>

<verification>
1. TypeScript compiles without errors: `pnpm typecheck`
2. Lint passes: `pnpm lint`
3. Inventory config has exactly 2 itemFields (name, estimatedValue)
4. Trade config has exactly 3 itemFields (type, name, estimatedSavings)
5. Lifestyle subscriptions uses dynamic-list with 2 itemFields and "Add subscription" button
</verification>

<success_criteria>
- Items to sell form shows only name and estimated price (no category dropdown)
- Borrow form shows only type, item name, and cost saved (no "from whom" text field)
- Subscriptions step shows "Add subscription" button and allows multiple entries
- Each subscription entry has name and monthly cost fields
- No TypeScript or lint errors
</success_criteria>

<output>
After completion, create `.planning/phases/07-ux-improvements/07-02-SUMMARY.md`
</output>
